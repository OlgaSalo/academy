# Урок 1: Дерево прийняття рішень \(decision tree\)

Вашa двоюрідна сестра заробила мільйони доларів спекулюючи на нерухомості. Вона запропонувала вам стати діловим партнером через ваш інтерес до науки про дані: вона заплатить вам гроші, а ви створите модель, яка передбачає, скільки вартують різні будинки.

Ви запитуєте: як вона прогнозувала вартість нерухомості в минулому, а вона відповідає, що це просто інтуїція. Але ваші додаткові питання виявляють, що вона визначала цінові закономірності будинків, які бачила у минулому, і використовує ці знання для прогнозування вартості нових будинків, які розглядає.

Машинне навчання працює схожим чином. Ми почнемо з моделі, яка називається _**деревом прийняття рішень**_. Є звісно вигадливіші моделі, які дають точніші прогнози. Але дерева прийняття рішень легко зрозуміти, і вони є базовим елементом для кращих моделей в науці про дані.

Для простоти ми почнемо з максимально елементарного дерева._\* Глибина дерева\*\* - це міра того, скільки **сплітів** \(_розгалужень\*\) модель робить перед тим, як дійти до прогнозу

![](../../.gitbook/assets/image%20%2887%29.png)

Ця модель ділить будинки лише на дві категорії. Прогнозована ціна на будь-який будинок, що розглядається, є середньою історичною ціною будинків тієї самої категорії.

Ми використовуємо дані, щоб вирішити, ЯК розбити будинки на дві групи, а потім знову визначити прогнозовану ціну в кожній групі. Цей етап фіксації шаблонів з даних називається пристосуванням або _**навчанням моделі**_. Дані, що використовуються для _**підгонки моделі**_, називаються _**навчальними даними**_.

Після того, як модель пристосована \(підігнана\), ви можете застосувати її до нових даних, щоб передбачити ціни на інші будинки.

###  **Покращуючи модель**

Найбільшим недоліком минулої моделі є те, що вона не враховує більшість факторів, що впливають на ціну будинку, таких як кількість ванних кімнат, розмір ділянки, розташування, тощо.

Ви можете взяти до уваги більше факторів, використовуючи дерево, яке має більше "розбиттів" -- **сплітів**. Вони називаються "_глибшими_" деревами. Дерево рішень, яке також враховує площу кожного будинку, може виглядати так:

![](../../.gitbook/assets/image%20%2894%29.png)

 Ви прогнозуєте ціну будь-якого будинку, завжди вибираючи шлях, що відповідає характеристикам цього будинку. Прогнозована ціна на будинок знаходиться внизу дерева. Пункти в останньому рядку, де ми робимо прогноз, називаються **листками**.

### Досліджуючи ваші дані \(бібліотекою Pandas\)

Першим кроком у будь-якому проекті машинного навчання є ознайомлення з даними. Для цього ви будете використовувати бібліотеку Pandas. Pandas - основний інструмент даних, який вчені використовують для вивчення та обробки даних. Більшість людей посилаються на Pandas у своєму коді як pd. Ми це робимо командою

```text
import pandas as pd
```

Найважливішою частиною бібліотеки Pandas є DataFrame. DataFrame містить тип даних, який ви можете сприймати як таблицю. Це схоже на аркуш у Excel або таблицю в базі даних SQL.

Pandas має потужні методи для більшості речей, які ви хочете зробити з даними цього типу.

Перед тим, як працювати з данними, їх потрібно спочатку завантажити. Для цього,

1\) Завантажте файл на свій гугл диск

2\) Отримайте його шлях на гугл диску \(приклад буде у коді нижче\)

Для цього курсу ми будемо використовувати набір даних \(aka _**dataset**_\) характеристик будинків Мельбурну за посиланням 

[https://drive.google.com/file/d/1BaQexn8PONGMUBWBnY6qi6PqXX-rpxV5/view?usp=sharing](https://drive.google.com/file/d/1BaQexn8PONGMUBWBnY6qi6PqXX-rpxV5/view?usp=sharing)

```text
#Під'єднуємось до гугл диску
from google.colab import drive
drive.mount('/content/drive')
```

```text
# шлях до датасету з даними про будинки Мельбурну
melbourne_file_path = '/content/drive/MyDrive/melb_data.csv'

# Створіть об'єкт, який міститиме в собі наш датасет
melbourne_data = pd.read_csv(melbourne_file_path) 
```

 Маючи готовий до маніпуляцій датасет, тепер ми можемо його описати функцією `.describe()`

```text
melbourne_data.describe() #На виході отримуємо базові статистині дані:

#count - к-сть даних
#mean - середнє арифметичне
#std - стандартне відхилення
```



|  | Rooms | Price | Distance | Postcode | Bedroom2 | Bathroom | Car | Landsize | BuildingArea | YearBuilt | Lattitude | Longtitude | Propertycount |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| count | 13580.000000 | 1.358000e+04 | 13580.000000 | 13580.000000 | 13580.000000 | 13580.000000 | 13518.000000 | 13580.000000 | 7130.000000 | 8205.000000 | 13580.000000 | 13580.000000 | 13580.000000 |
| mean | 2.937997 | 1.075684e+06 | 10.137776 | 3105.301915 | 2.914728 | 1.534242 | 1.610075 | 558.416127 | 151.967650 | 1964.684217 | -37.809203 | 144.995216 | 7454.417378 |
| std | 0.955748 | 6.393107e+05 | 5.868725 | 90.676964 | 0.965921 | 0.691712 | 0.962634 | 3990.669241 | 541.014538 | 37.273762 | 0.079260 | 0.103916 | 4378.581772 |
| min | 1.000000 | 8.500000e+04 | 0.000000 | 3000.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 0.000000 | 1196.000000 | -38.182550 | 144.431810 | 249.000000 |
| 25% | 2.000000 | 6.500000e+05 | 6.100000 | 3044.000000 | 2.000000 | 1.000000 | 1.000000 | 177.000000 | 93.000000 | 1940.000000 | -37.856822 | 144.929600 | 4380.000000 |
| 50% | 3.000000 | 9.030000e+05 | 9.200000 | 3084.000000 | 3.000000 | 1.000000 | 2.000000 | 440.000000 | 126.000000 | 1970.000000 | -37.802355 | 145.000100 | 6555.000000 |
| 75% | 3.000000 | 1.330000e+06 | 13.000000 | 3148.000000 | 3.000000 | 2.000000 | 2.000000 | 651.000000 | 174.000000 | 1999.000000 | -37.756400 | 145.058305 | 10331.000000 |
| max | 10.000000 | 9.000000e+06 | 48.100000 | 3977.000000 | 20.000000 | 8.000000 | 10.000000 | 433014.000000 | 44515.000000 | 2018.000000 | -37.408530 | 145.526350 | 21650.000000 |

