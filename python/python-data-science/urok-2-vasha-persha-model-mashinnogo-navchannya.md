# Урок 2: Ваша перша модель Машинного Навчання

У нашому наборі даних було занадто багато змінних, щоб красиво їх описати. Як звести цей величезний обсяг даних до чогось, що можна осягнути?

Щоб вибрати змінні / стовпці, нам потрібно буде переглянути список усіх стовпців у наборі даних. Це робиться із функцією `columns` DataFrame \(нижній рядок коду нижче\).

```text
import pandas as pd

# шлях до датасету з даними про будинки Мельбурну
melbourne_file_path = '/content/drive/MyDrive/melb_data.csv'

# Створіть об'єкт, який міститиме в собі наш датасет
melbourne_data = pd.read_csv(melbourne_file_path) 

######################
melbourne_data.columns
```

```text
Index(['Suburb', 'Address', 'Rooms', 'Type', 'Price', 'Method', 'SellerG',
       'Date', 'Distance', 'Postcode', 'Bedroom2', 'Bathroom', 'Car',
       'Landsize', 'BuildingArea', 'YearBuilt', 'CouncilArea', 'Lattitude',
       'Longtitude', 'Regionname', 'Propertycount'],
      dtype='object')
```

```text
# Дані будинків Мельбурну містять пусті комірки (деякі змінні деяких характеристик будинків не були записані)
# Ми навчимося як працювати з опущеними даними згодом 
# А поки, щоб уникнути труднощів, ми не враховуватимемо ВСІ будинки, у яких є пропущені змінні

melbourne_data = melbourne_data.dropna(axis=0)
```

###  **Вибір цілі для прогнозування**

Основна ціль машинного навчання -- це маючи вхідний набір даних видати результат-прогноз, який модель визначила після ряду "навчань".

Для тренування нам треба два набори даних: **параметри** та **ціль для прогнозування**. У нашому випадку параметрами будуть "кімнати, рік будування, широта, тощо...", а ціллю для прогнозування -- власне вартість будинку.

Ми будемо використовувати _крапкове позначення_, щоб вибрати стовпець, який ми хочемо передбачити \(_ціль для прогнозування_\). Прийнято позначати ціль прогнозування змінною **y**.

Отже, кодом, який нам потрібен для збереження цін на житло в даних Мельбурна, буде

```text
y = melbourne_data.Price
```

###  **Вибір параметрів**

Стовпці, які вводяться в нашу модель \(і згодом використовуються для прогнозування\), називаються "**параметрами**". У нашому випадку, це стовпці, що використовуються для визначення ціни на житло. Іноді ви будете використовувати всі стовпці, крім цілі, як параметри. А іншим разом вам буде раціональніше працювати з меншою кількістю параметрів.

Наразі ми створимо модель із лише кількома функціями.

Ми обираємо кілька функцій, надаючи список назв стовпців у дужках. Кожен елемент у цьому списку повинен бути елементом типу string \(тобто з лапками\).

Ось приклад:

```text
melbourne_features = ['Rooms', 'Bathroom', 'Landsize', 'Lattitude', 'Longtitude']
```

 Прийнято параметри позначати через **Х**

```text
X = melbourne_data[melbourne_features]
```

Давайте глянемо на наші параметри!

```text
X.describe()
```



|  | Rooms | Bathroom | Landsize | Lattitude | Longtitude |
| :--- | :--- | :--- | :--- | :--- | :--- |
| count | 6196.000000 | 6196.000000 | 6196.000000 | 6196.000000 | 6196.000000 |
| mean | 2.931407 | 1.576340 | 471.006940 | -37.807904 | 144.990201 |
| std | 0.971079 | 0.711362 | 897.449881 | 0.075850 | 0.099165 |
| min | 1.000000 | 1.000000 | 0.000000 | -38.164920 | 144.542370 |
| 25% | 2.000000 | 1.000000 | 152.000000 | -37.855438 | 144.926198 |
| 50% | 3.000000 | 1.000000 | 373.000000 | -37.802250 | 144.995800 |
| 75% | 4.000000 | 2.000000 | 628.000000 | -37.758200 | 145.052700 |
| max | 8.000000 | 8.000000 | 37000.000000 | -37.457090 | 145.526350 |

```text
X.head()
```

|  Rooms | Bathroom | Landsize | Lattitude | Longtitude |
| :--- | :--- | :--- | :--- | :--- |


| 1 | 2 | 1.0 | 156.0 | -37.8079 | 144.9934 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| 2 | 3 | 2.0 | 134.0 | -37.8093 | 144.9944 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| 4 | 4 | 1.0 | 120.0 | -37.8072 | 144.9941 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| 6 | 3 | 2.0 | 245.0 | -37.8024 | 144.9993 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| 7 | 2 | 1.0 | 256.0 | -37.8060 | 144.9954 |
| :--- | :--- | :--- | :--- | :--- | :--- |


###  **Будуючи першу модель**

Ви будете використовувати бібліотеку `scikit-learn` для створення своїх моделей. Під час кодування ця бібліотека записується як `sklearn`, як ви побачите у зразку коду. `Scikit-learn` - це найпопулярніша бібліотека для моделювання типів даних, які зазвичай зберігаються в `DataFrames`.

Етапи побудови та використання моделі:

* Визначте: якого типу це буде модель? Дерево рішень? Якийсь інший тип моделі? Вказуються також деякі інші параметри типу моделі.
* Підженіть: створіть шаблони із наданих даних. Це серце моделювання.
* Спрогнозуйте: що ж... нічого додати
* Оцініть: Визначте, наскільки точні прогнози вашої моделі.

Ось приклад визначення моделі дерева рішень за допомогою scikit-learn та узгодження її з параметрами та цільовою змінною.

```text
from sklearn.tree import DecisionTreeRegressor

# Визначте модуль. Уточніть число для random_statе, щоб гарантувати однакові результати кожен раз, коли проганятимите код
melbourne_model = DecisionTreeRegressor(random_state=1)

# Підженіть модель!
melbourne_model.fit(X, y)
```

```text
DecisionTreeRegressor(ccp_alpha=0.0, criterion='mse', max_depth=None,
                      max_features=None, max_leaf_nodes=None,
                      min_impurity_decrease=0.0, min_impurity_split=None,
                      min_samples_leaf=1, min_samples_split=2,
                      min_weight_fraction_leaf=0.0, presort='deprecated',
                      random_state=1, splitter='best')
```

Тепер у нас є модель, яку ми можемо використовувати для прогнозування.

На практиці вам потрібно буде робити прогнози щодо нових будинків, що виходять на ринок, а не будинків, на які ми вже маємо ціни. Але ми зробимо прогнози для перших декількох рядків навчальних даних, щоб побачити, як працює функція передбачення `.predict()`

```text
print("Робимо прогнозм для наступних 5 будинків:")
print(X.head())
print("передбачення їхніх цін є такими:")
print(melbourne_model.predict(X.head()))
```

Робимо прогнози для наступних 5 будинків:

|  | Rooms  | Bathroom | Landsize | Lattitude | Longtitude |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | 2 | 1.0 | 156.0 | -37.8079 | 144.9934 |
| 2 | 3 | 2.0 | 134.0 | -37.8093 | 144.9944 |
| 4 | 4 | 1.0 | 120.0 | -37.8072 | 144.9941 |
| 6 | 3 | 2.0 | 245.0 | -37.8024 | 144.9993 |
| 7 | 2 | 1.0 | 256.0 | -37.8060 | 44.9954 |

Передбачення їхніх цін є такими: \[1035000. 1465000. 1600000. 1876000. 1636000.\]

